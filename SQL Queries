Postgre SQL Code-

---------KPI Requirements-------

//Overlook of the Dataset

SELECT * FROM pizza_orders
LIMIT 5;

---Q1)Total revenue

SELECT SUM(total_price) AS Total_revenue FROM pizza_orders;

---Q2)Average order value

SELECT SUM(total_price)/ COUNT(DISTINCT Order_id) AS Average_order_value
FROM pizza_orders;

---Q3) Total Pizzas sold 
SELECT SUM(quantity) AS Total_pizza_sold FROM pizza_orders;

---Q4)Total orders
SELECT COUNT(DISTINCT Order_id) AS Total_Orders FROM pizza_orders;

---Q5)Average pizzas per order 
SELECT SUM(quantity) / COUNT(DISTINCT Order_id) AS Average_pizza_sold FROM pizza_orders;

---Q6)Daily trend for Total orders
SELECT TO_CHAR(order_date,'Day') as order_day,
COUNT (DISTINCT Order_id) AS Total_orders
FROM pizza_orders
GROUP BY TO_CHAR(order_date,'Day')
ORDER BY 
    CASE TRIM(TO_CHAR(order_date,'Day'))
	   WHEN 'Sunday' THEN 1
	   WHEN 'Monday' THEN 2
	   WHEN 'Tuesday'THEN 3
	   WHEN 'Wednesday'THEN 4
	   WHEN 'Thursday'THEN 5
	   WHEN 'Friday'THEN 6
	   WHEN 'Saturday'THEN 7
	  end;

---Q7)Monthly trend for Total orders
SELECT TO_CHAR(order_date,'Month') AS Month_name,Count(Distinct order_id) AS Total_orders
FROM pizza_orders
GROUP BY TO_CHAR(order_date,'Month')
ORDER BY Total_orders DESC;

---Q8)Percentage of sales by pizza category 
 SELECT pizza_category,CAST(sum(total_price)*100/(SELECT SUM(total_price)from pizza_orders)AS DECIMAL(10,2))
AS Total_percent_sales
From pizza_orders
Group by pizza_category;

---Q9) Percentage of sales by pizza size 
SELECT pizza_size,CAST(sum(total_price)*100/(SELECT SUM(total_price)from pizza_orders)AS DECIMAL(10,2))
AS Total_percent_sales
From pizza_orders
Group by pizza_size
Order by Total_percent_sales;

---Q10)Top 5 pizzas sold by revenue 
SELECT pizza_name AS Top_5_pizzas, sum(total_price)AS Total_revenue
From pizza_orders
Group by pizza_name
ORDER BY total_revenue DESC
LIMIT 5;

---Q11)Top 5 pizzas sold by quantity 
SELECT pizza_name AS Top_5_pizzas, sum(quantity )AS Total_quantity
From pizza_orders
Group by pizza_name
ORDER BY total_quantity DESC
LIMIT 5;

---Q12) Top 5 pizzas sold by Orders
SELECT pizza_name AS Top_5_pizzas, COUNT(DISTINCT order_id )AS Total_orders
From pizza_orders
Group by pizza_name
ORDER BY Total_orders DESC
LIMIT 5;

---Q13) Bottom 5 pizzas sold by revenue
 SELECT pizza_name AS Bottom_5_pizzas, sum(total_price)AS Total_revenue
From pizza_orders
Group by pizza_name
ORDER BY total_revenue 
LIMIT 5;

---Q14) Bottom 5 pizzas sold  by Quantity
SELECT pizza_name AS Bottom_5_pizzas, sum(quantity)AS Total_quantity
From pizza_orders
Group by pizza_name
ORDER BY total_quantity 
LIMIT 5;

---Q15) Bottom 5 pizzas by Orders
SELECT pizza_name AS Bottom_5_pizzas, COUNT(DISTINCT order_id )AS Total_orders
From pizza_orders
Group by pizza_name
ORDER BY Total_orders
LIMIT 5;

---Q16)Number of customers each day
SELECT order_date,COUNT(DISTINCT order_id) AS num_customers
FROM pizza_orders
GROUP BY order_date
ORDER BY order_date;

---Q17)Busiest hours
SELECT EXTRACT(HOUR FROM order_time)::INT AS order_hour, COUNT(DISTINCT order_id) AS numof_orders
FROM pizza_orders
GROUP BY order_hour
ORDER BY numof_orders DESC;




























